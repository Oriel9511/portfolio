---
import TagProjectPill from "./TagProjectPill.astro";
const {title, description, tags} = Astro.props;

// Handle both string and object formats for title and description
const getTitle = (title) => {
  if (typeof title === 'string') return title;
  return title?.en || ''; // Default to English if object format
};

const getDescription = (description) => {
  if (typeof description === 'string') return description;
  return description?.en || ''; // Default to English if object format
};
---

<article class="card p-4 sm:p-6 group hover:scale-[1.02] transition-all duration-300 project-card">
    <div class="space-y-3 sm:space-y-4">
        <h3 set:html={getTitle(title)} 
            class="text-lg sm:text-xl lg:text-2xl font-bold text-white group-hover:text-blue-300 transition-colors duration-200 project-title leading-tight" 
            data-title-en={typeof title === 'object' ? title?.en : title}
            data-title-es={typeof title === 'object' ? title?.es : title}
        ></h3>
        
        <p set:html={getDescription(description)} 
           class="text-gray-300 leading-relaxed text-sm sm:text-base project-description"
           data-desc-en={typeof description === 'object' ? description?.en : description}
           data-desc-es={typeof description === 'object' ? description?.es : description}
        ></p>
        
        <div class="pt-2">
            <TagProjectPill tags={tags}/>
        </div>
    </div>
    
    <!-- Subtle gradient overlay on hover -->
    <div class="absolute inset-0 bg-gradient-to-br from-blue-500/5 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-lg pointer-events-none"></div>
</article>

<script>
    import { currentLanguage } from '../../i18n/languageStore';
    
    function updateProjectsText() {
        const lang = currentLanguage.get();
        const projectCards = document.querySelectorAll('.project-card');
        
        projectCards.forEach(card => {
            const title = card.querySelector('.project-title');
            const description = card.querySelector('.project-description');
            
            if (title) {
                const titleText = title.getAttribute(`data-title-${lang}`);
                if (titleText) title.innerHTML = titleText;
            }
            
            if (description) {
                const descText = description.getAttribute(`data-desc-${lang}`);
                if (descText) description.innerHTML = descText;
            }
        });
    }
    
    // Update on language change
    currentLanguage.subscribe(updateProjectsText);
    
    // Initial update
    document.addEventListener('DOMContentLoaded', updateProjectsText);
</script>
